<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>아티스트 프로필 목록 페이지</title>
    <link rel="stylesheet" type="text/css" href="list.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="container">
    <h1>아티스트 프로필 목록</h1>
    <hr>

    <div id="artistList">
    </div>

    <div class="pagination" id="pagination">
    </div>

    <div class="search">
        <div class="label-container">
            <span>이름+내용</span>
            <div class="vertical-line"></div>
        </div>
        <div class="input-container">
            <input type="text" id="searchQuery">
        </div>
        <div class="vertical-line"></div>
        <div class="icon-container" onclick="search()">
            <span class="material-icons">search</span>
        </div>
    </div>
</div>

<script>
    function loadArtists(page) {
        $.get('http://tobiasdev.ml/services/artist/api/artists?page=' + page + '&size=2', function(data, status, xhr) {
            $('#artistList').empty();
            data.forEach(function(artist) {
                $('#artistList').append(
                    '<div class="profile">' +
                    '<img src="' + artist.imgUrl + '" class="profile-img" alt="Artist ' + artist.name + '">' +
                    '<h3>' + artist.name + '</h3>' +
                    '</div>'
                );
            });

            // 페이지네이션 구현
            var totalPages = xhr.getResponseHeader('X-Total-Pages');  // API 응답 헤더에서 전체 페이지 수를 가져옴 (API에 따라 다름)
            $('#pagination').empty();
            for (var i = 1; i <= totalPages; i++) {
                if (i === page) {
                    $('#pagination').append('<span class="current-page">' + i + '</span>');  // 현재 페이지를 표시
                } else {
                    $('#pagination').append('<span class="page-link" onclick="loadArtists(' + i + ')">' + i + '</span>');  // 페이지 링크를 생성
                }
            }
        });
    }


    function search() {
        let query = $('#searchQuery').val();
        $.get('http://tobiasdev.ml/services/artist/api/artists?search=' + query, function(data) {
            $('#artistList').empty();
            data.forEach(function(artist) {
                $('#artistList').append(
                    '<div class="profile">' +
                    '<img src="' + artist.imgUrl + '" class="profile-img" alt="Artist ' + artist.name + '">' +
                    '<h3>' + artist.name + '</h3>' +
                    '</div>'
                );
            });
        });
    }

    // 페이지 로드 시 첫 페이지의 아티스트 목록을 로드합니다.
    loadArtists(1);
</script>
</body>
</html>
